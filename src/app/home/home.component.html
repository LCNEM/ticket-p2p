<mat-sidenav-container>
    <mat-sidenav #sidenav class="mat-elevation-z16">
        <mat-toolbar class="background-contain" [ngStyle]="{'background-image': 'url(favicon.svg)'}">
        </mat-toolbar>
        <div fxLayout="column">
            <mat-nav-list>
                <mat-list-item routerLink="/events/archived">
                    <mat-icon mat-list-icon>archive</mat-icon>
                    {{translation.archived[global.lang]}}
                </mat-list-item>
                <mat-divider></mat-divider>
                <mat-list-item (click)="logout()">
                    <mat-icon mat-list-icon>lock_open</mat-icon>
                    {{translation.logout[global.lang]}}
                </mat-list-item>
            </mat-nav-list>
        </div>
    </mat-sidenav>
    <mat-sidenav-content>
        <mat-toolbar color="primary" class="mat-elevation-z4">
            <button mat-icon-button (click)="sidenav.toggle()">
                <mat-icon>menu</mat-icon>
            </button>
            <button mat-icon-button class="background-contain" [ngStyle]="{'background-image': 'url(favicon.svg)'}"></button>
            <span>ちけっとピアツーピア</span>

            <span class="fill-remaining-space"></span>

            <button mat-icon-button (click)="refresh()" [disabled]="loading">
                <mat-icon>refresh</mat-icon>
            </button>

            <mat-menu #langMenu="matMenu" [overlapTrigger]="false">
                <button mat-menu-item (click)="global.lang = 'en'">
                    English
                </button>
                <button mat-menu-item (click)="global.lang = 'ja'">
                    日本語
                </button>
            </mat-menu>
            <button mat-icon-button [matMenuTriggerFor]="langMenu" yPosition="below">
                {{global.lang}}
            </button>
        </mat-toolbar>
        <div class="out-toolbar">
            <mat-spinner *ngIf="loading; else loaded"></mat-spinner>
            <ng-template #loaded>
                <div fxLayout="row wrap">
                    <div *ngFor="let event of global.eventIds" fxFlex.xs="100" fxFlex.sm="50" fxFlex="25">
                        <mat-card>
                            <img mat-card-image src="https://chart.googleapis.com/chart?cht=p&amp;chd=t:{{global.events[event].purchases}},{{global.events[event].available}}&amp;chs=300x300&amp;chf=EEEEEE"
                                *ngIf="global.events[event].capacity">
                            <img mat-card-image src="https://chart.googleapis.com/chart?cht=p&amp;chd=t:0,1&amp;chs=300x300&amp;chf=EEEEEE"
                                *ngIf="!global.events[event].capacity">
                            <mat-card-header>
                                <mat-card-title>
                                    {{global.events[event].name}}
                                </mat-card-title>
                            </mat-card-header>
                            <mat-card-content>
                                <p class="capacity">
                                    {{global.events[event].purchases}}/{{global.events[event].capacity}}
                                </p>
                            </mat-card-content>
                            <mat-card-actions style="display: flex;">
                                <span class="fill-remaining-space"></span>
                                <button mat-icon-button (click)="archiveEvent(event)">
                                    <mat-icon>archive</mat-icon>
                                </button>
                                <button mat-icon-button routerLink="/events/{{event}}">
                                    <mat-icon>open_in_new</mat-icon>
                                </button>
                            </mat-card-actions>
                        </mat-card>
                    </div>
                </div>

                <p *ngIf="!global.eventIds.length" style="text-align: center;">{{translation.empty[global.lang]}}</p>
                <button mat-fab color="accent" class="add-button" (click)="createEvent()">
                    <mat-icon>add</mat-icon>
                </button>
            </ng-template>
        </div>
    </mat-sidenav-content>
</mat-sidenav-container>